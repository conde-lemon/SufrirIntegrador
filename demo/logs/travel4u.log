2025-11-20 00:28:15.263 [Test worker] INFO  c.t.demo.ReservaIntegrationTest - Starting ReservaIntegrationTest using Java 21.0.7 with PID 24380 (started by LENOVO in C:\Users\LENOVO\Documents\utp\ciclo7\integrador\demo (1)\demo)
2025-11-20 00:28:15.268 [Test worker] DEBUG c.t.demo.ReservaIntegrationTest - Running with Spring Boot v3.5.6, Spring v6.2.11
2025-11-20 00:28:15.271 [Test worker] INFO  c.t.demo.ReservaIntegrationTest - The following 1 profile is active: "h2"
2025-11-20 00:28:16.023 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-20 00:28:16.117 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 82 ms. Found 10 JPA repository interfaces.
2025-11-20 00:28:17.133 [Test worker] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-20 00:28:17.154 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-20 00:28:17.403 [Test worker] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-11-20 00:28:17.411 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-20 00:28:17.436 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-20 00:28:18.555 [Test worker] DEBUG org.hibernate.SQL - 
    create table detalle_reserva (
        id_detalle_reserva integer generated by default as identity,
        apellido varchar(255),
        asiento_seleccionado varchar(255),
        cantidad integer not null,
        correo varchar(255),
        created_at timestamp(6),
        documento varchar(255),
        fecha_nacimiento date,
        nombre varchar(255),
        precio_unitario numeric(10,2) not null,
        sexo varchar(255),
        subtotal numeric(10,2) not null,
        telefono varchar(255),
        id_reserva integer not null,
        id_servicio bigint not null,
        primary key (id_detalle_reserva)
    )
2025-11-20 00:28:18.567 [Test worker] DEBUG org.hibernate.SQL - 
    create table equipaje (
        id_equipaje integer generated by default as identity,
        activo boolean not null,
        descripcion TEXT,
        dimension_alto numeric(8,2) not null,
        dimension_ancho numeric(8,2) not null,
        dimension_largo numeric(8,2) not null,
        peso_max numeric(8,2) not null,
        precio numeric(10,2) not null,
        tipo varchar(255) not null,
        primary key (id_equipaje)
    )
2025-11-20 00:28:18.571 [Test worker] DEBUG org.hibernate.SQL - 
    create table historial (
        id_historial integer generated by default as identity,
        fecha timestamp(6),
        termino_busqueda varchar(255),
        id_usuario bigint,
        primary key (id_historial)
    )
2025-11-20 00:28:18.576 [Test worker] DEBUG org.hibernate.SQL - 
    create table oferta (
        id_oferta bigint generated by default as identity,
        activa boolean,
        descripcion varchar(255),
        descuento numeric(38,2),
        etiquetas varchar(255),
        fecha_creacion timestamp(6),
        fecha_extraccion timestamp(6),
        fecha_fin timestamp(6),
        fecha_inicio timestamp(6),
        fuente varchar(255),
        nombre varchar(255) not null,
        precio numeric(38,2) not null,
        url varchar(255),
        primary key (id_oferta)
    )
2025-11-20 00:28:18.581 [Test worker] DEBUG org.hibernate.SQL - 
    create table pago (
        id_pago integer generated by default as identity,
        created_at timestamp(6),
        estado_pago varchar(255) not null,
        fecha_pago timestamp(6),
        metodo_pago varchar(255) not null,
        monto numeric(12,2) not null,
        referencia_pago varchar(255),
        updated_at timestamp(6),
        id_reserva integer not null,
        primary key (id_pago)
    )
2025-11-20 00:28:18.584 [Test worker] DEBUG org.hibernate.SQL - 
    create table paquete (
        id_paquete integer generated by default as identity,
        descripcion TEXT,
        fecha_paquete timestamp(6),
        nombre varchar(255) not null,
        precio_total numeric(10,2) not null,
        primary key (id_paquete)
    )
2025-11-20 00:28:18.586 [Test worker] DEBUG org.hibernate.SQL - 
    create table paquete_reserva (
        id_paquete_reserva integer generated by default as identity,
        cantidad integer not null,
        created_at timestamp(6),
        precio_unitario numeric(10,2) not null,
        subtotal numeric(10,2) not null,
        id_paquete integer not null,
        id_reserva integer not null,
        primary key (id_paquete_reserva)
    )
2025-11-20 00:28:18.593 [Test worker] DEBUG org.hibernate.SQL - 
    create table proveedor (
        id_proveedor integer generated by default as identity,
        activo boolean not null,
        contacto varchar(255),
        email varchar(255),
        nombre varchar(255) not null,
        telefono varchar(255),
        tipo_proveedor varchar(255) not null,
        primary key (id_proveedor)
    )
2025-11-20 00:28:18.597 [Test worker] DEBUG org.hibernate.SQL - 
    create table reserva (
        id_reserva integer generated by default as identity,
        created_at timestamp(6),
        estado varchar(255) not null,
        fecha_fin timestamp(6),
        fecha_inicio timestamp(6),
        moneda varchar(255),
        observaciones TEXT,
        total numeric(12,2) not null,
        updated_at timestamp(6),
        id_usuario bigint not null,
        primary key (id_reserva)
    )
2025-11-20 00:28:18.599 [Test worker] DEBUG org.hibernate.SQL - 
    create table reserva_equipaje (
        id_reserva_equipaje integer generated by default as identity,
        cantidad integer not null,
        created_at timestamp(6),
        precio_unitario numeric(10,2) not null,
        subtotal numeric(10,2) not null,
        id_equipaje integer not null,
        id_reserva integer not null,
        primary key (id_reserva_equipaje)
    )
2025-11-20 00:28:18.603 [Test worker] DEBUG org.hibernate.SQL - 
    create table servicio (
        id_servicio bigint generated by default as identity,
        activo boolean not null,
        created_at timestamp(6),
        descripcion TEXT,
        destino varchar(255),
        disponibilidad integer not null,
        nombre varchar(255) not null,
        origen varchar(255),
        precio_base numeric(10,2) not null,
        tags varchar(255),
        tipo_servicio varchar(255) not null,
        id_proveedor integer,
        primary key (id_servicio)
    )
2025-11-20 00:28:18.605 [Test worker] DEBUG org.hibernate.SQL - 
    create table servicio_proveedor (
        id_servicio_proveedor integer generated by default as identity,
        created_at timestamp(6),
        id_proveedor integer not null,
        id_servicio bigint not null,
        primary key (id_servicio_proveedor)
    )
2025-11-20 00:28:18.612 [Test worker] DEBUG org.hibernate.SQL - 
    create table usuarios (
        id_usuario bigint generated by default as identity,
        activo boolean not null,
        apellidos varchar(255),
        email varchar(255) not null,
        fecha_registro timestamp(6),
        nombres varchar(255),
        password varchar(255) not null,
        rol varchar(255) not null,
        telefono varchar(255),
        primary key (id_usuario)
    )
2025-11-20 00:28:18.624 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       drop constraint if exists UK9droltiebt0cf6j4m77h83cyq
2025-11-20 00:28:18.628 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint UK9droltiebt0cf6j4m77h83cyq unique (id_reserva)
2025-11-20 00:28:18.634 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       drop constraint if exists UK5j8hug6mrtyvigc5d1chfiw7d
2025-11-20 00:28:18.634 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       add constraint UK5j8hug6mrtyvigc5d1chfiw7d unique (id_usuario)
2025-11-20 00:28:18.634 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       drop constraint if exists UK10mfc62ndk37e2fw14tmy3dld
2025-11-20 00:28:18.634 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       add constraint UK10mfc62ndk37e2fw14tmy3dld unique (id_reserva)
2025-11-20 00:28:18.634 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists usuarios 
       drop constraint if exists UKkfsp0s1tflm1cwlj8idhqsad0
2025-11-20 00:28:18.640 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists usuarios 
       add constraint UKkfsp0s1tflm1cwlj8idhqsad0 unique (email)
2025-11-20 00:28:18.640 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint FKj1lhl92oacmjdyvrkateyvcw1 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:28:18.648 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint FKdwdjkltsu86o8j31w5h2bppqw 
       foreign key (id_servicio) 
       references servicio
2025-11-20 00:28:18.648 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       add constraint FKek6x4bxyi1ipmpa5teiejpngg 
       foreign key (id_usuario) 
       references usuarios
2025-11-20 00:28:18.648 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       add constraint FKcf877idupj5b48wjatfaws6sg 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:28:18.653 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists paquete_reserva 
       add constraint FKlqr40r9xc74kyq630n1n6b5f 
       foreign key (id_paquete) 
       references paquete
2025-11-20 00:28:18.655 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists paquete_reserva 
       add constraint FKebw19vylvsjhlj36t8yqis3d2 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:28:18.655 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva 
       add constraint FKj8cxeodpmehovje6152y4ywqm 
       foreign key (id_usuario) 
       references usuarios
2025-11-20 00:28:18.659 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva_equipaje 
       add constraint FKj4lwal6wnv2rd3wtty1nef2te 
       foreign key (id_equipaje) 
       references equipaje
2025-11-20 00:28:18.659 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva_equipaje 
       add constraint FKc5vte8990g713bdr65lu9tntx 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:28:18.663 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio 
       add constraint FKjs76o250eufkn3ta34e8ahw2e 
       foreign key (id_proveedor) 
       references proveedor
2025-11-20 00:28:18.663 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio_proveedor 
       add constraint FKb3ymubrc6050tqpb7hmhoicfo 
       foreign key (id_proveedor) 
       references proveedor
2025-11-20 00:28:18.663 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio_proveedor 
       add constraint FKmu5qtgtfxtg0fep05ocq3fw2l 
       foreign key (id_servicio) 
       references servicio
2025-11-20 00:28:18.669 [Test worker] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-20 00:28:19.503 [Test worker] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-20 00:28:19.537 [Test worker] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page template: index
2025-11-20 00:28:19.793 [Test worker] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsServiceImpl
2025-11-20 00:28:20.230 [Test worker] INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-11-20 00:28:20.298 [Test worker] INFO  c.t.demo.ReservaIntegrationTest - Started ReservaIntegrationTest in 5.428 seconds (process running for 6.71)
2025-11-20 00:28:20.732 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        usuarios
        (activo, apellidos, email, fecha_registro, nombres, password, rol, telefono, id_usuario) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:28:20.765 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        servicio
        (activo, created_at, descripcion, destino, disponibilidad, nombre, origen, precio_base, id_proveedor, tags, tipo_servicio, id_servicio) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:28:20.770 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        equipaje
        (activo, descripcion, dimension_alto, dimension_ancho, dimension_largo, peso_max, precio, tipo, id_equipaje) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:28:20.775 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        reserva
        (created_at, estado, fecha_fin, fecha_inicio, moneda, observaciones, total, updated_at, id_usuario, id_reserva) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:28:20.775 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        detalle_reserva
        (apellido, asiento_seleccionado, cantidad, correo, created_at, documento, fecha_nacimiento, nombre, precio_unitario, id_reserva, id_servicio, sexo, subtotal, telefono, id_detalle_reserva) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:28:20.775 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        reserva_equipaje
        (cantidad, created_at, id_equipaje, precio_unitario, id_reserva, subtotal, id_reserva_equipaje) 
    values
        (?, ?, ?, ?, ?, ?, default)
2025-11-20 00:28:20.833 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-20 00:28:20.835 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-20 00:28:20.835 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-20 00:32:08.802 [Test worker] INFO  c.t.demo.ReservaControllerTest - Starting ReservaControllerTest using Java 21.0.7 with PID 20144 (started by LENOVO in C:\Users\LENOVO\Documents\utp\ciclo7\integrador\demo (1)\demo)
2025-11-20 00:32:08.802 [Test worker] DEBUG c.t.demo.ReservaControllerTest - Running with Spring Boot v3.5.6, Spring v6.2.11
2025-11-20 00:32:08.802 [Test worker] INFO  c.t.demo.ReservaControllerTest - The following 1 profile is active: "h2"
2025-11-20 00:32:09.541 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-20 00:32:09.623 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 74 ms. Found 10 JPA repository interfaces.
2025-11-20 00:32:10.711 [Test worker] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-20 00:32:10.740 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-20 00:32:10.930 [Test worker] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-11-20 00:32:10.938 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-20 00:32:10.971 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-20 00:32:12.268 [Test worker] DEBUG org.hibernate.SQL - 
    create table detalle_reserva (
        id_detalle_reserva integer generated by default as identity,
        apellido varchar(255),
        asiento_seleccionado varchar(255),
        cantidad integer not null,
        correo varchar(255),
        created_at timestamp(6),
        documento varchar(255),
        fecha_nacimiento date,
        nombre varchar(255),
        precio_unitario numeric(10,2) not null,
        sexo varchar(255),
        subtotal numeric(10,2) not null,
        telefono varchar(255),
        id_reserva integer not null,
        id_servicio bigint not null,
        primary key (id_detalle_reserva)
    )
2025-11-20 00:32:12.282 [Test worker] DEBUG org.hibernate.SQL - 
    create table equipaje (
        id_equipaje integer generated by default as identity,
        activo boolean not null,
        descripcion TEXT,
        dimension_alto numeric(8,2) not null,
        dimension_ancho numeric(8,2) not null,
        dimension_largo numeric(8,2) not null,
        peso_max numeric(8,2) not null,
        precio numeric(10,2) not null,
        tipo varchar(255) not null,
        primary key (id_equipaje)
    )
2025-11-20 00:32:12.285 [Test worker] DEBUG org.hibernate.SQL - 
    create table historial (
        id_historial integer generated by default as identity,
        fecha timestamp(6),
        termino_busqueda varchar(255),
        id_usuario bigint,
        primary key (id_historial)
    )
2025-11-20 00:32:12.288 [Test worker] DEBUG org.hibernate.SQL - 
    create table oferta (
        id_oferta bigint generated by default as identity,
        activa boolean,
        descripcion varchar(255),
        descuento numeric(38,2),
        etiquetas varchar(255),
        fecha_creacion timestamp(6),
        fecha_extraccion timestamp(6),
        fecha_fin timestamp(6),
        fecha_inicio timestamp(6),
        fuente varchar(255),
        nombre varchar(255) not null,
        precio numeric(38,2) not null,
        url varchar(255),
        primary key (id_oferta)
    )
2025-11-20 00:32:12.292 [Test worker] DEBUG org.hibernate.SQL - 
    create table pago (
        id_pago integer generated by default as identity,
        created_at timestamp(6),
        estado_pago varchar(255) not null,
        fecha_pago timestamp(6),
        metodo_pago varchar(255) not null,
        monto numeric(12,2) not null,
        referencia_pago varchar(255),
        updated_at timestamp(6),
        id_reserva integer not null,
        primary key (id_pago)
    )
2025-11-20 00:32:12.296 [Test worker] DEBUG org.hibernate.SQL - 
    create table paquete (
        id_paquete integer generated by default as identity,
        descripcion TEXT,
        fecha_paquete timestamp(6),
        nombre varchar(255) not null,
        precio_total numeric(10,2) not null,
        primary key (id_paquete)
    )
2025-11-20 00:32:12.298 [Test worker] DEBUG org.hibernate.SQL - 
    create table paquete_reserva (
        id_paquete_reserva integer generated by default as identity,
        cantidad integer not null,
        created_at timestamp(6),
        precio_unitario numeric(10,2) not null,
        subtotal numeric(10,2) not null,
        id_paquete integer not null,
        id_reserva integer not null,
        primary key (id_paquete_reserva)
    )
2025-11-20 00:32:12.300 [Test worker] DEBUG org.hibernate.SQL - 
    create table proveedor (
        id_proveedor integer generated by default as identity,
        activo boolean not null,
        contacto varchar(255),
        email varchar(255),
        nombre varchar(255) not null,
        telefono varchar(255),
        tipo_proveedor varchar(255) not null,
        primary key (id_proveedor)
    )
2025-11-20 00:32:12.303 [Test worker] DEBUG org.hibernate.SQL - 
    create table reserva (
        id_reserva integer generated by default as identity,
        created_at timestamp(6),
        estado varchar(255) not null,
        fecha_fin timestamp(6),
        fecha_inicio timestamp(6),
        moneda varchar(255),
        observaciones TEXT,
        total numeric(12,2) not null,
        updated_at timestamp(6),
        id_usuario bigint not null,
        primary key (id_reserva)
    )
2025-11-20 00:32:12.306 [Test worker] DEBUG org.hibernate.SQL - 
    create table reserva_equipaje (
        id_reserva_equipaje integer generated by default as identity,
        cantidad integer not null,
        created_at timestamp(6),
        precio_unitario numeric(10,2) not null,
        subtotal numeric(10,2) not null,
        id_equipaje integer not null,
        id_reserva integer not null,
        primary key (id_reserva_equipaje)
    )
2025-11-20 00:32:12.306 [Test worker] DEBUG org.hibernate.SQL - 
    create table servicio (
        id_servicio bigint generated by default as identity,
        activo boolean not null,
        created_at timestamp(6),
        descripcion TEXT,
        destino varchar(255),
        disponibilidad integer not null,
        nombre varchar(255) not null,
        origen varchar(255),
        precio_base numeric(10,2) not null,
        tags varchar(255),
        tipo_servicio varchar(255) not null,
        id_proveedor integer,
        primary key (id_servicio)
    )
2025-11-20 00:32:12.306 [Test worker] DEBUG org.hibernate.SQL - 
    create table servicio_proveedor (
        id_servicio_proveedor integer generated by default as identity,
        created_at timestamp(6),
        id_proveedor integer not null,
        id_servicio bigint not null,
        primary key (id_servicio_proveedor)
    )
2025-11-20 00:32:12.314 [Test worker] DEBUG org.hibernate.SQL - 
    create table usuarios (
        id_usuario bigint generated by default as identity,
        activo boolean not null,
        apellidos varchar(255),
        email varchar(255) not null,
        fecha_registro timestamp(6),
        nombres varchar(255),
        password varchar(255) not null,
        rol varchar(255) not null,
        telefono varchar(255),
        primary key (id_usuario)
    )
2025-11-20 00:32:12.319 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       drop constraint if exists UK9droltiebt0cf6j4m77h83cyq
2025-11-20 00:32:12.319 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint UK9droltiebt0cf6j4m77h83cyq unique (id_reserva)
2025-11-20 00:32:12.319 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       drop constraint if exists UK5j8hug6mrtyvigc5d1chfiw7d
2025-11-20 00:32:12.319 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       add constraint UK5j8hug6mrtyvigc5d1chfiw7d unique (id_usuario)
2025-11-20 00:32:12.319 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       drop constraint if exists UK10mfc62ndk37e2fw14tmy3dld
2025-11-20 00:32:12.319 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       add constraint UK10mfc62ndk37e2fw14tmy3dld unique (id_reserva)
2025-11-20 00:32:12.325 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists usuarios 
       drop constraint if exists UKkfsp0s1tflm1cwlj8idhqsad0
2025-11-20 00:32:12.325 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists usuarios 
       add constraint UKkfsp0s1tflm1cwlj8idhqsad0 unique (email)
2025-11-20 00:32:12.325 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint FKj1lhl92oacmjdyvrkateyvcw1 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:32:12.328 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint FKdwdjkltsu86o8j31w5h2bppqw 
       foreign key (id_servicio) 
       references servicio
2025-11-20 00:32:12.333 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       add constraint FKek6x4bxyi1ipmpa5teiejpngg 
       foreign key (id_usuario) 
       references usuarios
2025-11-20 00:32:12.335 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       add constraint FKcf877idupj5b48wjatfaws6sg 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:32:12.337 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists paquete_reserva 
       add constraint FKlqr40r9xc74kyq630n1n6b5f 
       foreign key (id_paquete) 
       references paquete
2025-11-20 00:32:12.337 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists paquete_reserva 
       add constraint FKebw19vylvsjhlj36t8yqis3d2 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:32:12.340 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva 
       add constraint FKj8cxeodpmehovje6152y4ywqm 
       foreign key (id_usuario) 
       references usuarios
2025-11-20 00:32:12.340 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva_equipaje 
       add constraint FKj4lwal6wnv2rd3wtty1nef2te 
       foreign key (id_equipaje) 
       references equipaje
2025-11-20 00:32:12.343 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva_equipaje 
       add constraint FKc5vte8990g713bdr65lu9tntx 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:32:12.345 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio 
       add constraint FKjs76o250eufkn3ta34e8ahw2e 
       foreign key (id_proveedor) 
       references proveedor
2025-11-20 00:32:12.345 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio_proveedor 
       add constraint FKb3ymubrc6050tqpb7hmhoicfo 
       foreign key (id_proveedor) 
       references proveedor
2025-11-20 00:32:12.345 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio_proveedor 
       add constraint FKmu5qtgtfxtg0fep05ocq3fw2l 
       foreign key (id_servicio) 
       references servicio
2025-11-20 00:32:12.352 [Test worker] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-20 00:32:13.079 [Test worker] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-20 00:32:13.112 [Test worker] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page template: index
2025-11-20 00:32:13.346 [Test worker] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsServiceImpl
2025-11-20 00:32:13.799 [Test worker] INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-11-20 00:32:13.875 [Test worker] INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-11-20 00:32:13.875 [Test worker] INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-11-20 00:32:13.875 [Test worker] INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 0 ms
2025-11-20 00:32:13.914 [Test worker] INFO  c.t.demo.ReservaControllerTest - Started ReservaControllerTest in 5.513 seconds (process running for 6.782)
2025-11-20 00:32:14.549 [Test worker] DEBUG org.hibernate.SQL - 
    select
        u1_0.id_usuario,
        u1_0.activo,
        u1_0.apellidos,
        u1_0.email,
        u1_0.fecha_registro,
        u1_0.nombres,
        u1_0.password,
        u1_0.rol,
        u1_0.telefono 
    from
        usuarios u1_0 
    where
        u1_0.email=?
2025-11-20 00:32:14.595 [Test worker] DEBUG org.hibernate.SQL - 
    select
        r1_0.id_reserva,
        r1_0.created_at,
        r1_0.estado,
        r1_0.fecha_fin,
        r1_0.fecha_inicio,
        r1_0.moneda,
        r1_0.observaciones,
        r1_0.total,
        r1_0.updated_at,
        r1_0.id_usuario 
    from
        reserva r1_0 
    where
        r1_0.id_usuario=? 
    order by
        r1_0.created_at desc
2025-11-20 00:32:14.966 [Test worker] DEBUG org.hibernate.SQL - 
    select
        u1_0.id_usuario,
        u1_0.activo,
        u1_0.apellidos,
        u1_0.email,
        u1_0.fecha_registro,
        u1_0.nombres,
        u1_0.password,
        u1_0.rol,
        u1_0.telefono 
    from
        usuarios u1_0 
    where
        u1_0.email=?
2025-11-20 00:32:14.970 [Test worker] DEBUG org.hibernate.SQL - 
    select
        r1_0.id_reserva,
        r1_0.created_at,
        r1_0.estado,
        r1_0.fecha_fin,
        r1_0.fecha_inicio,
        r1_0.moneda,
        r1_0.observaciones,
        r1_0.total,
        r1_0.updated_at,
        r1_0.id_usuario 
    from
        reserva r1_0 
    where
        r1_0.id_usuario=? 
    order by
        r1_0.created_at desc
2025-11-20 00:32:14.991 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-20 00:32:14.999 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-20 00:32:15.003 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-20 00:36:02.393 [Test worker] INFO  c.t.d.c.ReservaControllerTest - Starting ReservaControllerTest using Java 21.0.7 with PID 23988 (started by LENOVO in C:\Users\LENOVO\Documents\utp\ciclo7\integrador\demo (1)\demo)
2025-11-20 00:36:02.395 [Test worker] DEBUG c.t.d.c.ReservaControllerTest - Running with Spring Boot v3.5.6, Spring v6.2.11
2025-11-20 00:36:02.397 [Test worker] INFO  c.t.d.c.ReservaControllerTest - The following 1 profile is active: "h2"
2025-11-20 00:36:03.187 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-20 00:36:03.280 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 87 ms. Found 10 JPA repository interfaces.
2025-11-20 00:36:04.576 [Test worker] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-20 00:36:04.608 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-20 00:36:04.805 [Test worker] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-11-20 00:36:04.810 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-20 00:36:04.837 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-20 00:36:06.104 [Test worker] DEBUG org.hibernate.SQL - 
    create table detalle_reserva (
        id_detalle_reserva integer generated by default as identity,
        apellido varchar(255),
        asiento_seleccionado varchar(255),
        cantidad integer not null,
        correo varchar(255),
        created_at timestamp(6),
        documento varchar(255),
        fecha_nacimiento date,
        nombre varchar(255),
        precio_unitario numeric(10,2) not null,
        sexo varchar(255),
        subtotal numeric(10,2) not null,
        telefono varchar(255),
        id_reserva integer not null,
        id_servicio bigint not null,
        primary key (id_detalle_reserva)
    )
2025-11-20 00:36:06.117 [Test worker] DEBUG org.hibernate.SQL - 
    create table equipaje (
        id_equipaje integer generated by default as identity,
        activo boolean not null,
        descripcion TEXT,
        dimension_alto numeric(8,2) not null,
        dimension_ancho numeric(8,2) not null,
        dimension_largo numeric(8,2) not null,
        peso_max numeric(8,2) not null,
        precio numeric(10,2) not null,
        tipo varchar(255) not null,
        primary key (id_equipaje)
    )
2025-11-20 00:36:06.120 [Test worker] DEBUG org.hibernate.SQL - 
    create table historial (
        id_historial integer generated by default as identity,
        fecha timestamp(6),
        termino_busqueda varchar(255),
        id_usuario bigint,
        primary key (id_historial)
    )
2025-11-20 00:36:06.121 [Test worker] DEBUG org.hibernate.SQL - 
    create table oferta (
        id_oferta bigint generated by default as identity,
        activa boolean,
        descripcion varchar(255),
        descuento numeric(38,2),
        etiquetas varchar(255),
        fecha_creacion timestamp(6),
        fecha_extraccion timestamp(6),
        fecha_fin timestamp(6),
        fecha_inicio timestamp(6),
        fuente varchar(255),
        nombre varchar(255) not null,
        precio numeric(38,2) not null,
        url varchar(255),
        primary key (id_oferta)
    )
2025-11-20 00:36:06.123 [Test worker] DEBUG org.hibernate.SQL - 
    create table pago (
        id_pago integer generated by default as identity,
        created_at timestamp(6),
        estado_pago varchar(255) not null,
        fecha_pago timestamp(6),
        metodo_pago varchar(255) not null,
        monto numeric(12,2) not null,
        referencia_pago varchar(255),
        updated_at timestamp(6),
        id_reserva integer not null,
        primary key (id_pago)
    )
2025-11-20 00:36:06.124 [Test worker] DEBUG org.hibernate.SQL - 
    create table paquete (
        id_paquete integer generated by default as identity,
        descripcion TEXT,
        fecha_paquete timestamp(6),
        nombre varchar(255) not null,
        precio_total numeric(10,2) not null,
        primary key (id_paquete)
    )
2025-11-20 00:36:06.127 [Test worker] DEBUG org.hibernate.SQL - 
    create table paquete_reserva (
        id_paquete_reserva integer generated by default as identity,
        cantidad integer not null,
        created_at timestamp(6),
        precio_unitario numeric(10,2) not null,
        subtotal numeric(10,2) not null,
        id_paquete integer not null,
        id_reserva integer not null,
        primary key (id_paquete_reserva)
    )
2025-11-20 00:36:06.128 [Test worker] DEBUG org.hibernate.SQL - 
    create table proveedor (
        id_proveedor integer generated by default as identity,
        activo boolean not null,
        contacto varchar(255),
        email varchar(255),
        nombre varchar(255) not null,
        telefono varchar(255),
        tipo_proveedor varchar(255) not null,
        primary key (id_proveedor)
    )
2025-11-20 00:36:06.132 [Test worker] DEBUG org.hibernate.SQL - 
    create table reserva (
        id_reserva integer generated by default as identity,
        created_at timestamp(6),
        estado varchar(255) not null,
        fecha_fin timestamp(6),
        fecha_inicio timestamp(6),
        moneda varchar(255),
        observaciones TEXT,
        total numeric(12,2) not null,
        updated_at timestamp(6),
        id_usuario bigint not null,
        primary key (id_reserva)
    )
2025-11-20 00:36:06.135 [Test worker] DEBUG org.hibernate.SQL - 
    create table reserva_equipaje (
        id_reserva_equipaje integer generated by default as identity,
        cantidad integer not null,
        created_at timestamp(6),
        precio_unitario numeric(10,2) not null,
        subtotal numeric(10,2) not null,
        id_equipaje integer not null,
        id_reserva integer not null,
        primary key (id_reserva_equipaje)
    )
2025-11-20 00:36:06.137 [Test worker] DEBUG org.hibernate.SQL - 
    create table servicio (
        id_servicio bigint generated by default as identity,
        activo boolean not null,
        created_at timestamp(6),
        descripcion TEXT,
        destino varchar(255),
        disponibilidad integer not null,
        nombre varchar(255) not null,
        origen varchar(255),
        precio_base numeric(10,2) not null,
        tags varchar(255),
        tipo_servicio varchar(255) not null,
        id_proveedor integer,
        primary key (id_servicio)
    )
2025-11-20 00:36:06.139 [Test worker] DEBUG org.hibernate.SQL - 
    create table servicio_proveedor (
        id_servicio_proveedor integer generated by default as identity,
        created_at timestamp(6),
        id_proveedor integer not null,
        id_servicio bigint not null,
        primary key (id_servicio_proveedor)
    )
2025-11-20 00:36:06.142 [Test worker] DEBUG org.hibernate.SQL - 
    create table usuarios (
        id_usuario bigint generated by default as identity,
        activo boolean not null,
        apellidos varchar(255),
        email varchar(255) not null,
        fecha_registro timestamp(6),
        nombres varchar(255),
        password varchar(255) not null,
        rol varchar(255) not null,
        telefono varchar(255),
        primary key (id_usuario)
    )
2025-11-20 00:36:06.145 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       drop constraint if exists UK9droltiebt0cf6j4m77h83cyq
2025-11-20 00:36:06.149 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint UK9droltiebt0cf6j4m77h83cyq unique (id_reserva)
2025-11-20 00:36:06.153 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       drop constraint if exists UK5j8hug6mrtyvigc5d1chfiw7d
2025-11-20 00:36:06.153 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       add constraint UK5j8hug6mrtyvigc5d1chfiw7d unique (id_usuario)
2025-11-20 00:36:06.155 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       drop constraint if exists UK10mfc62ndk37e2fw14tmy3dld
2025-11-20 00:36:06.155 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       add constraint UK10mfc62ndk37e2fw14tmy3dld unique (id_reserva)
2025-11-20 00:36:06.155 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists usuarios 
       drop constraint if exists UKkfsp0s1tflm1cwlj8idhqsad0
2025-11-20 00:36:06.157 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists usuarios 
       add constraint UKkfsp0s1tflm1cwlj8idhqsad0 unique (email)
2025-11-20 00:36:06.158 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint FKj1lhl92oacmjdyvrkateyvcw1 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:36:06.160 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists detalle_reserva 
       add constraint FKdwdjkltsu86o8j31w5h2bppqw 
       foreign key (id_servicio) 
       references servicio
2025-11-20 00:36:06.160 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists historial 
       add constraint FKek6x4bxyi1ipmpa5teiejpngg 
       foreign key (id_usuario) 
       references usuarios
2025-11-20 00:36:06.168 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists pago 
       add constraint FKcf877idupj5b48wjatfaws6sg 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:36:06.168 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists paquete_reserva 
       add constraint FKlqr40r9xc74kyq630n1n6b5f 
       foreign key (id_paquete) 
       references paquete
2025-11-20 00:36:06.170 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists paquete_reserva 
       add constraint FKebw19vylvsjhlj36t8yqis3d2 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:36:06.172 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva 
       add constraint FKj8cxeodpmehovje6152y4ywqm 
       foreign key (id_usuario) 
       references usuarios
2025-11-20 00:36:06.174 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva_equipaje 
       add constraint FKj4lwal6wnv2rd3wtty1nef2te 
       foreign key (id_equipaje) 
       references equipaje
2025-11-20 00:36:06.174 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists reserva_equipaje 
       add constraint FKc5vte8990g713bdr65lu9tntx 
       foreign key (id_reserva) 
       references reserva
2025-11-20 00:36:06.178 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio 
       add constraint FKjs76o250eufkn3ta34e8ahw2e 
       foreign key (id_proveedor) 
       references proveedor
2025-11-20 00:36:06.179 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio_proveedor 
       add constraint FKb3ymubrc6050tqpb7hmhoicfo 
       foreign key (id_proveedor) 
       references proveedor
2025-11-20 00:36:06.183 [Test worker] DEBUG org.hibernate.SQL - 
    alter table if exists servicio_proveedor 
       add constraint FKmu5qtgtfxtg0fep05ocq3fw2l 
       foreign key (id_servicio) 
       references servicio
2025-11-20 00:36:06.185 [Test worker] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-20 00:36:07.052 [Test worker] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-20 00:36:07.089 [Test worker] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page template: index
2025-11-20 00:36:07.351 [Test worker] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userDetailsServiceImpl
2025-11-20 00:36:07.792 [Test worker] INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-11-20 00:36:07.865 [Test worker] INFO  c.t.d.c.ReservaControllerTest - Started ReservaControllerTest in 5.871 seconds (process running for 7.179)
2025-11-20 00:36:08.402 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        usuarios
        (activo, apellidos, email, fecha_registro, nombres, password, rol, telefono, id_usuario) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:36:08.428 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        servicio
        (activo, created_at, descripcion, destino, disponibilidad, nombre, origen, precio_base, id_proveedor, tags, tipo_servicio, id_servicio) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:36:08.434 [Test worker] DEBUG org.hibernate.SQL - 
    insert 
    into
        equipaje
        (activo, descripcion, dimension_alto, dimension_ancho, dimension_largo, peso_max, precio, tipo, id_equipaje) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-20 00:36:08.478 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-20 00:36:08.482 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-20 00:36:08.484 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
