<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selección de Asientos - Travel For U</title>
    <link rel="stylesheet" th:href="@{/css/header_style.css}">
    <link rel="stylesheet" th:href="@{/css/asientos_style.css}">
</head>

<body>
<div th:replace="~{fragments/header :: main-header}"></div>

<div class="container">
    <!-- El formulario ahora enviará todos los datos de la reserva -->
    <form th:action="@{/reservar/crear}" method="post" th:object="${reserva}">
        <div class="main-layout">
            <!-- El mapa de asientos es visual, no necesita cambios -->
            <aside class="seat-map-sidebar">
                <!-- ... tu mapa de asientos aquí ... -->
                <h4>Mapa de Asientos (Visual)</h4>
                <div class="seat-row">
                    <div class="seat">A1</div>
                    <div class="seat occupied">A2</div>
                </div>
            </aside>

            <main class="main-content">
                <!-- Sección de Datos del Pasajero -->
                <section class="personal-data-section">
                    <h2 class="section-title">Datos del Pasajero Principal</h2>
                    <div class="form-grid">
                        <div class="form-group form-row-full">
                            <label class="form-label">Nombre del Pasajero (para observaciones)</label>
                            <input type="text" class="form-input" placeholder="Ej: Juan Pérez" th:field="*{observaciones}" required>
                        </div>
                    </div>
                </section>

                <!-- NUEVA SECCIÓN: Selección de Equipaje -->
                <section class="baggage-section">
                    <h2 class="section-title">Añadir Equipaje</h2>
                    <div class="baggage-options" th:if="${!tiposDeEquipaje.isEmpty()}">
                        <!-- Iteramos sobre los tipos de equipaje que pasamos desde el controlador -->
                        <div class="baggage-option" th:each="equipaje : ${tiposDeEquipaje}">
                            <input type="checkbox" name="equipajeIds" th:value="${equipaje.idEquipaje}" th:id="'equipaje-' + ${equipaje.idEquipaje}">
                            <label th:for="'equipaje-' + ${equipaje.idEquipaje}">
                                <span class="baggage-type" th:text="${equipaje.tipo}">Equipaje de mano</span>
                                <span class="baggage-price" th:text="'+ S/ ' + ${#numbers.formatDecimal(equipaje.precio, 1, 'COMMA', 2, 'POINT')}">+ S/ 50.00</span>
                            </label>
                        </div>
                    </div>
                    <div th:if="${tiposDeEquipaje.isEmpty()}">
                        <p>No hay opciones de equipaje disponibles en este momento.</p>
                    </div>
                </section>

                <!-- Detalles del Vuelo y Confirmación -->
                <section class="reservation-details">
                    <h2 class="section-title">Detalles del Vuelo</h2>
                    <div class="details-grid">
                        <!-- ... (detalles del vuelo no cambian) ... -->
                    </div>
                </section>

                <div class="button-container">
                    <button type="submit" class="continue-button">Confirmar y Pagar</button>
                </div>
            </main>
        </div>
    </form>
</div>
</body>
</html>