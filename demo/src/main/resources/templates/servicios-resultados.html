<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${titulo} + ' - Travel For U'">Servicios - Travel For U</title>
    <link rel="stylesheet" th:href="@{/css/header_style.css}">
    <link rel="stylesheet" th:href="@{/css/index1_style.css}">
</head>
<body>
<div th:replace="~{fragments/header :: main-header}"></div>

<div class="container">
    <!-- Buscador reutilizable -->
    <div th:replace="~{fragments/search-form :: section}" th:with="titulo='Busca Servicios', action=@{/servicios/buscar}, tipoServicio=${tipoServicio}"></div>

    <hr style="margin: 40px 0;">

    <div class="results-header">
        <h2 class="section-title" th:text="${titulo}">Servicios</h2>
        <p th:if="${origen != null and destino != null}" th:text="'Resultados para: ' + ${origen} + ' → ' + ${destino}"></p>
    </div>

    <!-- Caso 1: Se encontraron servicios -->
    <div class="packages-grid" th:if="${servicios != null and !servicios.isEmpty()}">
        <article class="package-card" th:each="servicio : ${servicios}">
            <div class="package-content">
                <h3 class="package-title" th:text="${servicio.nombre}">Nombre del Servicio</h3>
                <p class="package-provider" th:text="${servicio.proveedor != null ? servicio.proveedor.nombre : 'Sin proveedor'}">Proveedor</p>
                <p class="package-description" th:text="${servicio.descripcion}">Descripción del servicio.</p>
                <div class="package-route" th:if="${servicio.origen != null and servicio.destino != null}">
                    <strong>Ruta:</strong> <span th:text="${servicio.origen} + ' → ' + ${servicio.destino}"></span>
                </div>
                <div class="package-tags" th:if="${servicio.tags != null and !servicio.tags.isEmpty()}">
                    <span th:each="tag : ${servicio.tags.split(',')}" class="package-tag" th:text="${tag}">etiqueta</span>
                </div>
                <div class="package-footer">
                    <span class="package-price" th:text="'S/ ' + ${#numbers.formatDecimal(servicio.precioBase, 1, 'COMMA', 2, 'POINT')}">$0.00</span>
                    <a th:href="@{/reservar/servicio/{id}(id=${servicio.idServicio})}" class="reserve-btn">Reservar</a>
                </div>
            </div>
        </article>
    </div>

    <!-- Caso 2: No se encontraron servicios, mostrar sugerencias -->
    <div th:if="${servicios == null or servicios.isEmpty()}">
        <div class="alert-info">
            <p th:text="'Lo sentimos, no se encontraron ' + ${titulo?.toLowerCase()} + ' para la búsqueda realizada.'">No se encontraron servicios.</p>
        </div>

        <div class="suggestions-section" th:if="${sugerencias != null and !sugerencias.isEmpty()}">
            <h3 class="section-title" style="margin-top: 40px; text-align: left;">Quizás te interese...</h3>
            <div class="packages-grid">
                <article class="package-card" th:each="sugerencia : ${sugerencias}">
                    <div class="package-content">
                        <h3 class="package-title" th:text="${sugerencia.nombre}">Nombre del Servicio</h3>
                        <p class="package-provider" th:text="${sugerencia.proveedor != null ? sugerencia.proveedor.nombre : 'Sin proveedor'}">Proveedor</p>
                        <p class="package-description" th:text="${sugerencia.descripcion}">Descripción del servicio.</p>
                        <div class="package-route" th:if="${sugerencia.origen != null and sugerencia.destino != null}">
                            <strong>Ruta:</strong> <span th:text="${sugerencia.origen} + ' → ' + ${sugerencia.destino}"></span>
                        </div>
                        <div class="package-tags" th:if="${sugerencia.tags != null and !sugerencia.tags.isEmpty()}">
                            <span th:each="tag : ${sugerencia.tags.split(',')}" class="package-tag" th:text="${tag}">etiqueta</span>
                        </div>
                        <div class="package-footer">
                            <span class="package-price" th:text="'S/ ' + ${#numbers.formatDecimal(sugerencia.precioBase, 1, 'COMMA', 2, 'POINT')}">$0.00</span>
                            <a th:href="@{/reservar/servicio/{id}(id=${sugerencia.idServicio})}" class="reserve-btn">Reservar</a>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </div>
</div>
</body>
</html>